<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Signadji - Editeur & Signature PDF</title>
  <link rel="icon" type="image/png" href="images/logo.png">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- App CSS -->
  <link rel="stylesheet" href="css/style.css">

  <!-- PDF.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

  <!-- pdf-lib -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>

  <!-- signature_pad -->
  <script src="https://cdn.jsdelivr.net/npm/signature_pad@5.0.4/dist/signature_pad.umd.min.js"></script>
</head>
<body>

  <!-- ===== TOP BAR ===== -->
  <header class="top-bar glass-panel">
    <div class="top-bar__left">
      <span class="logo">
        <img class="logo__icon" src="images/logo.png" alt="Signadji" width="28" height="28">
        <span class="logo__text">Signadji</span>
      </span>
    </div>
    <div class="top-bar__actions">
      <button id="btn-darkmode" class="btn btn--glass" title="Mode sombre">
        <svg class="icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="5"/>
          <line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/>
          <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
          <line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/>
          <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
        </svg>
        <svg class="icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/>
        </svg>
      </button>
      <a href="explorer.html" class="btn btn--glass" title="Explorateur de fichiers" style="text-decoration:none;">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
        </svg>
        <span class="btn__label">Explorer</span>
      </a>
      <button id="btn-feuille" class="btn btn--glass" title="Ouvrir Feuille Matériel">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
          <polyline points="14 2 14 8 20 8"/>
        </svg>
        <span class="btn__label">Feuille</span>
      </button>
      <button id="btn-import" class="btn btn--glass" title="Importer un PDF">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
          <polyline points="17 8 12 3 7 8"/>
          <line x1="12" y1="3" x2="12" y2="15"/>
        </svg>
        <span class="btn__label">Importer</span>
      </button>
      <button id="btn-text" class="btn btn--glass" disabled title="Ajouter du texte">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="4 7 4 4 20 4 20 7"/>
          <line x1="9" y1="20" x2="15" y2="20"/>
          <line x1="12" y1="4" x2="12" y2="20"/>
        </svg>
        <span class="btn__label">Texte</span>
      </button>
      <button id="btn-signature" class="btn btn--glass" disabled title="Ajouter une signature">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 17c3-3 5 2 8-1s3 1 6-2 3 1 4 0"/>
          <path d="M17 3l4 4-10 10H7v-4L17 3z"/>
        </svg>
        <span class="btn__label">Signature</span>
      </button>
      <div class="export-wrapper">
        <button id="btn-export" class="btn btn--primary" disabled title="Exporter le PDF">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          <span class="btn__label">Exporter</span>
        </button>
        <div id="export-menu" class="export-menu glass-panel" hidden>
          <button class="export-menu__item" data-action="download">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            Télécharger
          </button>
          <hr class="export-menu__divider">
          <span class="export-menu__label">Enregistrer sur le réseau</span>
          <button class="export-menu__item" data-action="save" data-year="2024">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
            </svg>
            Dossier 2024
          </button>
          <button class="export-menu__item" data-action="save" data-year="2025">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
            </svg>
            Dossier 2025
          </button>
          <button class="export-menu__item" data-action="save" data-year="2026">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"/>
            </svg>
            Dossier 2026
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- ===== DROP ZONE ===== -->
  <div id="drop-zone" class="drop-zone">
    <div class="drop-zone__content glass-panel">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#ff6fa3" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
        <line x1="12" y1="18" x2="12" y2="12"/>
        <polyline points="9 15 12 12 15 15"/>
      </svg>
      <p class="drop-zone__title">Glissez votre PDF ici</p>
      <p class="drop-zone__subtitle">ou cliquez pour parcourir</p>
      <input type="file" id="file-input" accept=".pdf,application/pdf" hidden>
    </div>
  </div>

  <!-- ===== MAIN CONTENT ===== -->
  <main id="main-content" class="main-content" hidden>
    <!-- Page navigation -->
    <div class="page-nav glass-panel">
      <button id="btn-prev" class="btn btn--icon" disabled title="Page precedente">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="15 18 9 12 15 6"/>
        </svg>
      </button>
      <span id="page-indicator" class="page-nav__indicator">1 / 1</span>
      <button id="btn-next" class="btn btn--icon" disabled title="Page suivante">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="9 6 15 12 9 18"/>
        </svg>
      </button>
    </div>

    <!-- PDF Viewer -->
    <div id="pdf-viewer" class="pdf-viewer">
      <div id="page-wrapper" class="page-wrapper">
        <canvas id="pdf-canvas"></canvas>
        <div id="overlay-layer" class="overlay-layer"></div>
      </div>
    </div>
  </main>

  <!-- ===== PROPERTIES PANEL ===== -->
  <aside id="properties-panel" class="properties-panel glass-panel" hidden>
    <div class="properties-panel__header">
      <h3>Proprietes</h3>
      <button id="btn-close-panel" class="btn btn--icon" title="Fermer">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"/>
          <line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    <div class="properties-panel__body">
      <label class="prop-label">
        Police
        <select id="prop-font" class="prop-input">
          <option value="Helvetica">Helvetica</option>
          <option value="Times-Roman">Times Roman</option>
          <option value="Courier">Courier</option>
        </select>
      </label>
      <label class="prop-label">
        Taille
        <div class="prop-row">
          <input type="range" id="prop-size" class="prop-range" min="8" max="72" value="16">
          <span id="prop-size-value" class="prop-value">16px</span>
        </div>
      </label>
      <label class="prop-label">
        Couleur
        <input type="color" id="prop-color" class="prop-color" value="#000000">
      </label>
      <div class="prop-row prop-row--buttons">
        <button id="prop-bold" class="btn btn--toggle" title="Gras"><b>B</b></button>
        <button id="prop-italic" class="btn btn--toggle" title="Italique"><i>I</i></button>
      </div>
      <hr class="prop-divider">
      <button id="prop-delete" class="btn btn--danger">Supprimer</button>
    </div>
  </aside>

  <!-- ===== SIGNATURE MODAL ===== -->
  <div id="signature-modal" class="modal" hidden>
    <div class="modal__backdrop"></div>
    <div class="modal__content glass-panel">
      <h2 class="modal__title">Dessinez votre signature</h2>
      <div class="signature-canvas-wrapper">
        <canvas id="signature-canvas"></canvas>
      </div>
      <div class="modal__actions">
        <button id="sig-clear" class="btn btn--glass">Effacer</button>
        <button id="sig-undo" class="btn btn--glass">Annuler trait</button>
        <button id="sig-cancel" class="btn btn--glass">Annuler</button>
        <button id="sig-confirm" class="btn btn--primary">Confirmer</button>
      </div>
    </div>
  </div>

  <!-- ===== FILENAME MODAL ===== -->
  <div id="filename-modal" class="modal" hidden>
    <div class="modal__backdrop" id="filename-backdrop"></div>
    <div class="modal__content glass-panel" style="max-width:420px;">
      <h2 class="modal__title">Nom du fichier</h2>
      <div class="filename-input-wrapper">
        <input type="text" id="filename-input" class="explorer__search" placeholder="Nom du fichier" value="Signadji-export">
        <span class="filename-ext">.pdf</span>
      </div>
      <div class="modal__actions">
        <button id="filename-cancel" class="btn btn--glass">Annuler</button>
        <button id="filename-confirm" class="btn btn--primary">Confirmer</button>
      </div>
    </div>
  </div>

  <!-- ===== TOAST CONTAINER ===== -->
  <div id="toast-container" class="toast-container"></div>

  <!-- ===== SCRIPTS ===== -->
  <script src="js/pdf-renderer.js"></script>
  <script src="js/overlay-manager.js"></script>
  <script src="js/text-editor.js"></script>
  <script src="js/signature.js"></script>
  <script src="js/exporter.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
